(self.webpackChunkcreate_chart=self.webpackChunkcreate_chart||[]).push([[2428],{19829:function(J,y,u){"use strict";u.r(y),u.d(y,{default:function(){return p}});var A=u(12444),D=u.n(A),B=u(72004),G=u.n(B),it=u(25098),nt=u.n(it),Y=u(31996),I=u.n(Y),z=u(26037),L=u.n(z),W=u(67294),rt=u(32075),b=u.n(rt),at=u(18334),c=u.n(at),k=u(94184),j=u.n(k),Z={"color-line-background":"color-line-background___l3J3a"},q=u(85893),$=function(Q){I()(R,Q);var l=L()(R);function R(m){var d;return D()(this,R),d=l.call(this,m),d.canvasRef=W.createRef(),d}return G()(R,[{key:"componentDidMount",value:function(){this.initCanvas(),this.resize=this.resize.bind(this),window.addEventListener("resize",this.resize)}},{key:"initCanvas",value:function(){var d=this.canvasRef.current,f=window.innerWidth,g=window.innerHeight;if(d.width=f,d.height=g,this.props.globalCompositeOperation){var P=d.getContext("2d");P.globalCompositeOperation=this.props.globalCompositeOperation}this.props.onCanvasInited&&this.props.onCanvasInited(d)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"resize",value:function(){var d=this.canvasRef.current,f=window.innerWidth,g=window.innerHeight;d.width=f,d.height=g,this.props.onResize&&this.props.onResize(f,g)}},{key:"handleMouseDown",value:function(d){this.props.onMouseDown&&this.props.onMouseDown(d)}},{key:"handleMouseMove",value:function(d){this.props.onMouseMove&&this.props.onMouseMove(d)}},{key:"handleMouseUp",value:function(d){this.props.onMouseUp&&this.props.onMouseUp(d)}},{key:"render",value:function(){return(0,q.jsx)("div",{className:"w-100 h-100",children:(0,q.jsx)("canvas",{ref:this.canvasRef,onMouseDown:this.handleMouseDown.bind(this),onMouseMove:this.handleMouseMove.bind(this),onMouseUp:this.handleMouseUp.bind(this),className:j()("w-100 h-100",Z["color-line-background"])})})}}]),R}(W.Component),V=function(Q){I()(R,Q);var l=L()(R);function R(m){var d;return D()(this,R),d=l.call(this,m),d._mousedown=!1,d.renderProton=d.renderProton.bind(nt()(d)),d}return G()(R,[{key:"handleCanvasInited",value:function(d){this.createProton(d),c().add(this.renderProton)}},{key:"componentWillUnmount",value:function(){try{c().remove(this.renderProton),this.proton.destroy()}catch(d){}}},{key:"createProton",value:function(d){var f=new(b()),g=new(b()).Emitter;g.damping=.008,g.rate=new(b()).Rate(250),g.addInitialize(new(b()).Mass(1)),g.addInitialize(new(b()).Radius(4)),g.addInitialize(new(b()).Velocity(new(b()).Span(1.5),new(b()).Span(0,360),"polar")),this.mouseInfo={x:1003/2,y:610/2},this.attractionBehaviour=new(b()).Attraction(this.mouseInfo,0,0),this.crossZoneBehaviour=new(b()).CrossZone(new(b()).RectZone(0,0,d.width,d.height),"cross"),g.addBehaviour(new(b()).Color("random")),g.addBehaviour(this.attractionBehaviour,this.crossZoneBehaviour),g.addBehaviour(new(b()).RandomDrift(10,10,.05)),g.p.x=d.width/2,g.p.y=d.height/2,g.emit("once"),f.addEmitter(g);var P=this.createRenderer(d);f.addRenderer(P),this.proton=f,this.renderer=P}},{key:"createRenderer",value:function(d){var f=d.getContext("2d"),g=new(b()).CanvasRenderer(d);return g.onProtonUpdate=function(){f.fillStyle="rgba(0, 0, 0, 0.02)",f.fillRect(0,0,d.width,d.height)},g.onParticleUpdate=function(P){f.beginPath(),f.strokeStyle=P.color,f.lineWidth=1,f.moveTo(P.old.p.x,P.old.p.y),f.lineTo(P.p.x,P.p.y),f.closePath(),f.stroke()},g}},{key:"handleResize",value:function(d,f){this.crossZoneBehaviour.reset(new(b()).RectZone(0,0,d,f),"cross"),this.renderer.resize(d,f)}},{key:"handleMouseDown",value:function(d){this._mousedown=!0,this.attractionBehaviour.reset(this.mouseInfo,10,1200),this.handleMouseMove(d)}},{key:"handleMouseMove",value:function(d){if(this._mousedown){var f,g;d.pageX||d.pageX===0?(f=d.pageX,g=d.pageY):(d.offsetX||d.offsetX===0)&&(f=d.offsetX,g=d.offsetY),this.mouseInfo.x=f,this.mouseInfo.y=g}}},{key:"handleMouseUp",value:function(d){this._mousedown=!1,this.attractionBehaviour.reset(this.mouseInfo,0,0)}},{key:"renderProton",value:function(){this.proton.update()}},{key:"render",value:function(){return(0,q.jsx)($,{onMouseDown:this.handleMouseDown.bind(this),onMouseMove:this.handleMouseMove.bind(this),onMouseUp:this.handleMouseUp.bind(this),onCanvasInited:this.handleCanvasInited.bind(this),onResize:this.handleResize.bind(this)})}}]),R}(W.Component),p=V},32075:function(J){(function(y,u){J.exports=u()})(this,function(){"use strict";function y(i,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function u(i,r){i.prototype=Object.create(r.prototype),i.prototype.constructor=i,A(i,r)}function A(i,r){return A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},A(i,r)}function D(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}var B=function(i){--i;for(var r=1;r<32;r<<=1)i|=i>>r;return i+1},G=function(i,r){return[1,0,0,0,1,0,i,r,1]},it=function(i){var r=Math.cos(i),e=Math.sin(i);return[r,-e,0,e,r,0,0,0,1]},nt=function(i,r){return[i,0,0,0,r,0,0,0,1]},Y=function(i,r){var e=i[0],t=i[1],n=i[2],a=i[3],s=i[4],o=i[5],h=i[6],E=i[7],v=i[8],C=r[0],M=r[1],U=r[2],S=r[3],H=r[4],X=r[5],ot=r[6],ht=r[7],lt=r[8];return[e*C+t*S+n*ot,e*M+t*H+n*ht,e*U+t*X+n*lt,a*C+s*S+o*ot,a*M+s*H+o*ht,a*U+s*X+o*lt,h*C+E*S+v*ot,h*M+E*H+v*ht,h*U+E*X+v*lt]},I={createCanvas:function(i,r,e,t){t===void 0&&(t="absolute");var n=document.createElement("canvas");return n.id=i,n.width=r,n.height=e,n.style.opacity=0,n.style.position=t,this.transform(n,-500,-500,0,0),n},createDiv:function(i,r,e){var t=document.createElement("div");return t.id=i,t.style.position="absolute",this.resize(t,r,e),t},resize:function(i,r,e){i.style.width=r+"px",i.style.height=e+"px",i.style.marginLeft=-r/2+"px",i.style.marginTop=-e/2+"px"},transform:function(i,r,e,t,n){i.style.willChange="transform";var a="translate("+r+"px, "+e+"px) scale("+t+") rotate("+n+"deg)";this.css3(i,"transform",a)},transform3d:function(i,r,e,t,n){i.style.willChange="transform";var a="translate3d("+r+"px, "+e+"px, 0) scale("+t+") rotate("+n+"deg)";this.css3(i,"backfaceVisibility","hidden"),this.css3(i,"transform",a)},css3:function(i,r,e){var t=r.charAt(0).toUpperCase()+r.substr(1);i.style["Webkit"+t]=e,i.style["Moz"+t]=e,i.style["O"+t]=e,i.style["ms"+t]=e,i.style[""+r]=e}},z={},L={},W=0,rt=function(i,r,e){i.drawImage(r,e.x,e.y);var t=i.getImageData(e.x,e.y,e.width,e.height);return i.clearRect(e.x,e.y,e.width,e.height),t},b=function(i,r,e){var t=typeof i=="string"?i:i.src;if(z[t])r(z[t],e);else{var n=new Image;n.onload=function(a){z[t]=a.target,r(z[t],e)},n.src=t}},at=function(i,r,e){var t=i.src;if(!L[t]){var n=B(i.width),a=B(i.height),s=I.createCanvas("proton_canvas_cache_"+ ++W,n,a);s.getContext("2d").drawImage(i,0,0,i.width,i.height),L[t]=s}return r&&r(L[t],e),L[t]},c={initValue:function(i,r){return i=i!=null?i:r},isArray:function(i){return Object.prototype.toString.call(i)==="[object Array]"},emptyArray:function(i){i&&(i.length=0)},toArray:function(i){return this.isArray(i)?i:[i]},sliceArray:function(i,r,e){this.emptyArray(e);for(var t=r;t<i.length;t++)e.push(i[t])},getRandFromArray:function(i){return i?i[Math.floor(i.length*Math.random())]:null},emptyObject:function(i,r){for(var e in r===void 0&&(r=null),i)r&&r.indexOf(e)>-1||delete i[e]},classApply:function(i,r){return r===void 0&&(r=null),r?new(i.bind.apply(i,[null].concat(r))):new i},getImageData:function(i,r,e){return rt(i,r,e)},destroyAll:function(i,r){r===void 0&&(r=null);for(var e=i.length;e--;){try{i[e].destroy(r)}catch(t){}delete i[e]}i.length=0},assign:function(i,r){if(typeof Object.assign!="function"){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(i[e]=r[e]);return i}return Object.assign(i,r)}},k={},j={_index:0,_cache:{},id:function(i){return k[i]!==void 0&&k[i]!==null||(k[i]=0),i+"_"+k[i]++},getId:function(i){var r=this.getIdFromCache(i);return r||(r="PUID_"+this._index++,this._cache[r]=i,r)},getIdFromCache:function(i){var r,e;for(e in this._cache)if((r=this._cache[e])===i||this.isBody(r,i)&&r.src===i.src)return e;return null},isBody:function(i,r){return typeof i=="object"&&typeof r=="object"&&i.isInner&&r.isInner},getTarget:function(i){return this._cache[i]}},Z=function(){function i(e){this.total=0,this.cache={}}var r=i.prototype;return r.get=function(e,t,n){var a;return n=n||e.__puid||j.getId(e),(a=this.cache[n]&&this.cache[n].length>0?this.cache[n].pop():this.createOrClone(e,t)).__puid=e.__puid||n,a},r.expire=function(e){return this.getCache(e.__puid).push(e)},r.createOrClone=function(e,t){return this.total++,this.create?this.create(e,t):typeof e=="function"?c.classApply(e,t):e.clone()},r.getCount=function(){var e=0;for(var t in this.cache)e+=this.cache[t].length;return e++},r.destroy=function(){for(var e in this.cache)this.cache[e].length=0,delete this.cache[e]},r.getCache=function(e){return e===void 0&&(e="default"),this.cache[e]||(this.cache[e]=[]),this.cache[e]},i}(),q=function(){function i(e){this.proton=e,this.container=null,this.type=1,this.emitterIndex=0,this.rendererIndex=0}var r=i.prototype;return r.update=function(e,t){this.add(e,t);var n=this.getEmitter(),a=this.getRenderer(),s="";switch(this.type){case 2:s+="emitter:"+this.proton.emitters.length+"<br>",n&&(s+="em speed:"+n.emitSpeed+"<br>"),n&&(s+="pos:"+this.getEmitterPos(n));break;case 3:n&&(s+="initializes:"+n.initializes.length+"<br>"),n&&(s+='<span style="display:inline-block;">'+this.concatArr(n.initializes)+"</span><br>"),n&&(s+="behaviours:"+n.behaviours.length+"<br>"),n&&(s+='<span style="display:inline-block;">'+this.concatArr(n.behaviours)+"</span><br>");break;case 4:a&&(s+=a.name+"<br>"),a&&(s+="body:"+this.getCreatedNumber(a)+"<br>");break;default:s+="particles:"+this.proton.getCount()+"<br>",s+="pool:"+this.proton.pool.getCount()+"<br>",s+="total:"+this.proton.pool.total}this.container.innerHTML=s},r.add=function(e,t){var n=this;if(!this.container){var a,s;switch(this.type=1,this.container=document.createElement("div"),this.container.style.cssText=["position:absolute;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;font-family:Helvetica,Arial,sans-serif;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this.container.addEventListener("click",function(o){n.type++,n.type>4&&(n.type=1)},!1),e){case 2:a="#201",s="#f08";break;case 3:a="#020",s="#0f0";break;default:a="#002",s="#0ff"}this.container.style["background-color"]=a,this.container.style.color=s}this.container.parentNode||(t=t||this.body||document.body).appendChild(this.container)},r.getEmitter=function(){return this.proton.emitters[this.emitterIndex]},r.getRenderer=function(){return this.proton.renderers[this.rendererIndex]},r.concatArr=function(e){var t="";if(!e||!e.length)return t;for(var n=0;n<e.length;n++)t+=(e[n].name||"").substr(0,1)+".";return t},r.getCreatedNumber=function(e){return e.pool.total||e.cpool&&e.cpool.total||0},r.getEmitterPos=function(e){return Math.round(e.p.x)+","+Math.round(e.p.y)},r.destroy=function(){this.container&&this.container.parentNode&&(this.body||document.body).removeChild(this.container),this.proton=null,this.container=null},i}(),$=function(){function i(){this._listeners=null}i.bind=function(e){e.prototype.dispatchEvent=i.prototype.dispatchEvent,e.prototype.hasEventListener=i.prototype.hasEventListener,e.prototype.addEventListener=i.prototype.addEventListener,e.prototype.removeEventListener=i.prototype.removeEventListener,e.prototype.removeAllEventListeners=i.prototype.removeAllEventListeners};var r=i.prototype;return r.addEventListener=function(e,t){return this._listeners?this.removeEventListener(e,t):this._listeners={},this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t),t},r.removeEventListener=function(e,t){if(this._listeners&&this._listeners[e]){for(var n=this._listeners[e],a=n.length,s=0;s<a;s++)if(n[s]===t){a===1?delete this._listeners[e]:n.splice(s,1);break}}},r.removeAllEventListeners=function(e){e?this._listeners&&delete this._listeners[e]:this._listeners=null},r.dispatchEvent=function(e,t){var n=!1,a=this._listeners;if(e&&a){var s,o=a[e];if(!o)return n;for(var h=o.length;h--;)s=o[h],n=n||s(t)}return!!n},r.hasEventListener=function(e){var t=this._listeners;return!(!t||!t[e])},i}(),V=3.1415926,p={PI:V,PIx2:2*V,PI_2:V/2,PI_180:V/180,N180_PI:180/V,Infinity:-999,isInfinity:function(i){return i===this.Infinity||i===1/0},randomAToB:function(i,r,e){return e===void 0&&(e=!1),e?(Math.random()*(r-i)>>0)+i:i+Math.random()*(r-i)},randomFloating:function(i,r,e){return this.randomAToB(i-r,i+r,e)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},randomZone:function(i){},floor:function(i,r){r===void 0&&(r=4);var e=Math.pow(10,r);return Math.floor(i*e)/e},degreeTransform:function(i){return i*V/180},toColor16:function(i){return"#"+i.toString(16)}},Q=function(){function i(e){this.type=e}var r=i.prototype;return r.calculate=function(e,t,n){this.eulerIntegrate(e,t,n)},r.eulerIntegrate=function(e,t,n){e.sleep||(e.old.p.copy(e.p),e.old.v.copy(e.v),e.a.multiplyScalar(1/e.mass),e.v.add(e.a.multiplyScalar(t)),e.p.add(e.old.v.multiplyScalar(t)),n&&e.v.multiplyScalar(n),e.a.clear())},i}(),l=function(){function i(a){this.emitters=[],this.renderers=[],this.time=0,this.now=0,this.then=0,this.elapsed=0,this.stats=new q(this),this.pool=new Z(80),this.integrationType=c.initValue(a,i.EULER),this.integrator=new Q(this.integrationType),this._fps="auto",this._interval=i.DEFAULT_INTERVAL}var r,e,t,n=i.prototype;return n.addRenderer=function(a){a.init(this),this.renderers.push(a)},n.removeRenderer=function(a){var s=this.renderers.indexOf(a);this.renderers.splice(s,1),a.remove(this)},n.addEmitter=function(a){this.emitters.push(a),a.parent=this,this.dispatchEvent(i.EMITTER_ADDED,a)},n.removeEmitter=function(a){var s=this.emitters.indexOf(a);this.emitters.splice(s,1),a.parent=null,this.dispatchEvent(i.EMITTER_REMOVED,a)},n.update=function(){this._fps==="auto"?(this.dispatchEvent(i.PROTON_UPDATE),i.USE_CLOCK?(this.then||(this.then=new Date().getTime()),this.now=new Date().getTime(),this.elapsed=.001*(this.now-this.then),this.amendChangeTabsBug(),this.elapsed>0&&this.emittersUpdate(this.elapsed),this.then=this.now):this.emittersUpdate(i.DEFAULT_INTERVAL),this.dispatchEvent(i.PROTON_UPDATE_AFTER)):(this.then||(this.then=new Date().getTime()),this.now=new Date().getTime(),this.elapsed=.001*(this.now-this.then),this.elapsed>this._interval&&(this.dispatchEvent(i.PROTON_UPDATE),this.emittersUpdate(this._interval),this.then=this.now-this.elapsed%this._interval*1e3,this.dispatchEvent(i.PROTON_UPDATE_AFTER)))},n.emittersUpdate=function(a){for(var s=this.emitters.length;s--;)this.emitters[s].update(a)},n.amendChangeTabsBug=function(){i.amendChangeTabsBug&&this.elapsed>.5&&(this.then=new Date().getTime(),this.elapsed=0)},n.getCount=function(){for(var a=0,s=this.emitters.length;s--;)a+=this.emitters[s].particles.length;return a},n.getAllParticles=function(){for(var a=[],s=this.emitters.length;s--;)a=a.concat(this.emitters[s].particles);return a},n.destroyAllEmitters=function(){c.destroyAll(this.emitters)},n.destroy=function(a){var s=this;a===void 0&&(a=!1);var o=function(){s.time=0,s.then=0,s.pool.destroy(),s.stats.destroy(),c.destroyAll(s.emitters),c.destroyAll(s.renderers,s.getAllParticles()),s.integrator=null,s.renderers=null,s.emitters=null,s.stats=null,s.pool=null};a?setTimeout(o,200):o()},r=i,(e=[{key:"fps",get:function(){return this._fps},set:function(a){this._fps=a,this._interval=a==="auto"?i.DEFAULT_INTERVAL:p.floor(1/a,7)}}])&&y(r.prototype,e),t&&y(r,t),i}();l.USE_CLOCK=!1,l.MEASURE=100,l.EULER="euler",l.RK2="runge-kutta2",l.PARTICLE_CREATED="PARTICLE_CREATED",l.PARTICLE_UPDATE="PARTICLE_UPDATE",l.PARTICLE_SLEEP="PARTICLE_SLEEP",l.PARTICLE_DEAD="PARTICLE_DEAD",l.EMITTER_ADDED="EMITTER_ADDED",l.EMITTER_REMOVED="EMITTER_REMOVED",l.PROTON_UPDATE="PROTON_UPDATE",l.PROTON_UPDATE_AFTER="PROTON_UPDATE_AFTER",l.DEFAULT_INTERVAL=.0167,l.amendChangeTabsBug=!0,$.bind(l);var R=function(){function i(r,e,t){r===void 0&&(r=255),e===void 0&&(e=255),t===void 0&&(t=255),this.r=r,this.g=e,this.b=t}return i.prototype.reset=function(){this.r=255,this.g=255,this.b=255},i}(),m={hasProp:function(i,r){return!!i&&i[r]!==void 0},setProp:function(i,r){for(var e in r)i.hasOwnProperty(e)&&(i[e]=Span.getSpanValue(r[e]));return i},setVectorVal:function(i,r){r===void 0&&(r=null),r&&(this.hasProp(r,"x")&&(i.p.x=r.x),this.hasProp(r,"y")&&(i.p.y=r.y),this.hasProp(r,"vx")&&(i.v.x=r.vx),this.hasProp(r,"vy")&&(i.v.y=r.vy),this.hasProp(r,"ax")&&(i.a.x=r.ax),this.hasProp(r,"ay")&&(i.a.y=r.ay),this.hasProp(r,"p")&&i.p.copy(r.p),this.hasProp(r,"v")&&i.v.copy(r.v),this.hasProp(r,"a")&&i.a.copy(r.a),this.hasProp(r,"position")&&i.p.copy(r.position),this.hasProp(r,"velocity")&&i.v.copy(r.velocity),this.hasProp(r,"accelerate")&&i.a.copy(r.accelerate))}},d={easeLinear:function(i){return i},easeInQuad:function(i){return Math.pow(i,2)},easeOutQuad:function(i){return-(Math.pow(i-1,2)-1)},easeInOutQuad:function(i){return(i/=.5)<1?.5*Math.pow(i,2):-.5*((i-=2)*i-2)},easeInCubic:function(i){return Math.pow(i,3)},easeOutCubic:function(i){return Math.pow(i-1,3)+1},easeInOutCubic:function(i){return(i/=.5)<1?.5*Math.pow(i,3):.5*(Math.pow(i-2,3)+2)},easeInQuart:function(i){return Math.pow(i,4)},easeOutQuart:function(i){return-(Math.pow(i-1,4)-1)},easeInOutQuart:function(i){return(i/=.5)<1?.5*Math.pow(i,4):-.5*((i-=2)*Math.pow(i,3)-2)},easeInSine:function(i){return 1-Math.cos(i*p.PI_2)},easeOutSine:function(i){return Math.sin(i*p.PI_2)},easeInOutSine:function(i){return-.5*(Math.cos(Math.PI*i)-1)},easeInExpo:function(i){return i===0?0:Math.pow(2,10*(i-1))},easeOutExpo:function(i){return i===1?1:1-Math.pow(2,-10*i)},easeInOutExpo:function(i){return i===0?0:i===1?1:(i/=.5)<1?.5*Math.pow(2,10*(i-1)):.5*(2-Math.pow(2,-10*--i))},easeInCirc:function(i){return-(Math.sqrt(1-i*i)-1)},easeOutCirc:function(i){return Math.sqrt(1-Math.pow(i-1,2))},easeInOutCirc:function(i){return(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)},easeInBack:function(i){var r=1.70158;return i*i*((r+1)*i-r)},easeOutBack:function(i){var r=1.70158;return(i-=1)*i*((r+1)*i+r)+1},easeInOutBack:function(i){var r=1.70158;return(i/=.5)<1?i*i*((1+(r*=1.525))*i-r)*.5:.5*((i-=2)*i*((1+(r*=1.525))*i+r)+2)},getEasing:function(i){return typeof i=="function"?i:this[i]||this.easeLinear}},f=function(){function i(e,t){this.x=e||0,this.y=t||0}var r=i.prototype;return r.set=function(e,t){return this.x=e,this.y=t,this},r.setX=function(e){return this.x=e,this},r.setY=function(e){return this.y=e,this},r.getGradient=function(){return this.x!==0?Math.atan2(this.y,this.x):this.y>0?p.PI_2:this.y<0?-p.PI_2:void 0},r.copy=function(e){return this.x=e.x,this.y=e.y,this},r.add=function(e,t){return t!==void 0?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this)},r.addXY=function(e,t){return this.x+=e,this.y+=t,this},r.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},r.sub=function(e,t){return t!==void 0?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this)},r.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},r.divideScalar=function(e){return e!==0?(this.x/=e,this.y/=e):this.set(0,0),this},r.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},r.negate=function(){return this.multiplyScalar(-1)},r.dot=function(e){return this.x*e.x+this.y*e.y},r.lengthSq=function(){return this.x*this.x+this.y*this.y},r.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.normalize=function(){return this.divideScalar(this.length())},r.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},r.rotate=function(e){var t=this.x,n=this.y;return this.x=t*Math.cos(e)+n*Math.sin(e),this.y=-t*Math.sin(e)+n*Math.cos(e),this},r.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},r.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},r.equals=function(e){return e.x===this.x&&e.y===this.y},r.clear=function(){return this.x=0,this.y=0,this},r.clone=function(){return new i(this.x,this.y)},i}(),g=function(){function i(e){this.id="",this.old=null,this.data=null,this.behaviours=null,this.p=null,this.v=null,this.a=null,this.rgb=null,this.name="Particle",this.id=j.id(this.name),this.old={},this.data={},this.behaviours=[],this.p=new f,this.v=new f,this.a=new f,this.old.p=new f,this.old.v=new f,this.old.a=new f,this.rgb=new R,this.reset(),e&&m.setProp(this,e)}var r=i.prototype;return r.getDirection=function(){return Math.atan2(this.v.x,-this.v.y)*p.N180_PI},r.reset=function(){return this.life=1/0,this.age=0,this.dead=!1,this.sleep=!1,this.body=null,this.sprite=null,this.parent=null,this.energy=1,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.easing=d.easeLinear,this.rgb.reset(),c.emptyObject(this.data),this.removeAllBehaviours(),this},r.update=function(e,t){if(this.sleep||(this.age+=e,this.applyBehaviours(e,t)),this.age<this.life){var n=this.easing(this.age/this.life);this.energy=Math.max(1-n,0)}else this.destroy()},r.applyBehaviours=function(e,t){var n,a=this.behaviours.length;for(n=0;n<a;n++)this.behaviours[n]&&this.behaviours[n].applyBehaviour(this,e,t)},r.addBehaviour=function(e){this.behaviours.push(e),e.hasOwnProperty("parents")&&e.parents.push(this),e.initialize(this)},r.addBehaviours=function(e){var t,n=e.length;for(t=0;t<n;t++)this.addBehaviour(e[t])},r.removeBehaviour=function(e){var t=this.behaviours.indexOf(e);t>-1&&(this.behaviours.splice(t,1).parents=null)},r.removeAllBehaviours=function(){c.emptyArray(this.behaviours)},r.destroy=function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null},i}(),P={hexToRgb:function(i){var r=i.charAt(0)==="#"?i.substring(1,7):i;return{r:parseInt(r.substring(0,2),16),g:parseInt(r.substring(2,4),16),b:parseInt(r.substring(4,6),16)}},rgbToHex:function(i){return"rgb("+i.r+", "+i.g+", "+i.b+")"},getHex16FromParticle:function(i){return 65536*Number(i.rgb.r)+256*Number(i.rgb.g)+Number(i.rgb.b)}},ut=function(){function i(e,t){this.r=Math.abs(e)||0,this.tha=t||0}var r=i.prototype;return r.set=function(e,t){return this.r=e,this.tha=t,this},r.setR=function(e){return this.r=e,this},r.setTha=function(e){return this.tha=e,this},r.copy=function(e){return this.r=e.r,this.tha=e.tha,this},r.toVector=function(){return new f(this.getX(),this.getY())},r.getX=function(){return this.r*Math.sin(this.tha)},r.getY=function(){return-this.r*Math.cos(this.tha)},r.normalize=function(){return this.r=1,this},r.equals=function(e){return e.r===this.r&&e.tha===this.tha},r.clear=function(){return this.r=0,this.tha=0,this},r.clone=function(){return new i(this.r,this.tha)},i}(),w={create:function(i){var r=new Float32Array(9);return i&&this.set(i,r),r},set:function(i,r){for(var e=0;e<9;e++)r[e]=i[e];return r},multiply:function(i,r,e){var t=i[0],n=i[1],a=i[2],s=i[3],o=i[4],h=i[6],E=i[7],v=r[0],C=r[1],M=r[2],U=r[3],S=r[4],H=r[6],X=r[7];return e[0]=v*t+C*s,e[1]=v*n+C*o,e[2]=a*M,e[3]=U*t+S*s,e[4]=U*n+S*o,e[6]=H*t+X*s+h,e[7]=H*n+X*o+E,e},inverse:function(i,r){var e,t=i[0],n=i[1],a=i[3],s=i[4],o=i[6],h=i[7],E=s,v=-a,C=h*a-s*o;return e=1/(t*E+n*v),r[0]=E*e,r[1]=-n*e,r[3]=v*e,r[4]=t*e,r[6]=C*e,r[7]=(-h*t+n*o)*e,r},multiplyVec2:function(i,r,e){var t=r[0],n=r[1];return e[0]=t*i[0]+n*i[3]+i[6],e[1]=t*i[1]+n*i[4]+i[7],e}},x=function(){function i(r,e,t){c.isArray(r)?(this.isArray=!0,this.a=r):(this.isArray=!1,this.a=c.initValue(r,1),this.b=c.initValue(e,this.a),this.center=c.initValue(t,!1))}return i.prototype.getValue=function(r){return r===void 0&&(r=!1),this.isArray?c.getRandFromArray(this.a):this.center?p.randomFloating(this.a,this.b,r):p.randomAToB(this.a,this.b,r)},i.setSpanValue=function(r,e,t){return r instanceof i?r:e===void 0?new i(r):t===void 0?new i(r,e):new i(r,e,t)},i.getSpanValue=function(r){return r instanceof i?r.getValue():r},i}(),O=function(i){function r(e){var t;return(t=i.call(this)||this)._arr=c.toArray(e),t}return u(r,i),r.prototype.getValue=function(){var e=c.getRandFromArray(this._arr);return e==="random"||e==="Random"?p.randomColor():e},r.createArraySpan=function(e){return e?e instanceof r?e:new r(e):null},r}(x),ct=function(){function i(r,e,t,n){this.x=r,this.y=e,this.width=t,this.height=n,this.bottom=this.y+this.height,this.right=this.x+this.width}return i.prototype.contains=function(r,e){return r<=this.right&&r>=this.x&&e<=this.bottom&&e>=this.y},i}(),dt=function(){function i(e,t){this.numPan=x.setSpanValue(c.initValue(e,1)),this.timePan=x.setSpanValue(c.initValue(t,1)),this.startTime=0,this.nextTime=0,this.init()}var r=i.prototype;return r.init=function(){this.startTime=0,this.nextTime=this.timePan.getValue()},r.getValue=function(e){return this.startTime+=e,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),this.numPan.b===1?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0},i}(),_=function(){function i(){}var r=i.prototype;return r.reset=function(){},r.init=function(e,t){t?this.initialize(t):this.initialize(e)},r.initialize=function(e){},i}(),xt=function(i){function r(e,t,n){var a;return(a=i.call(this)||this).lifePan=x.setSpanValue(e,t,n),a.name="Life",a}return u(r,i),r.prototype.initialize=function(e){this.lifePan.a===1/0?e.life=1/0:e.life=this.lifePan.getValue()},r}(_),N=function(){function i(){this.vector=new f(0,0),this.random=0,this.crossType="dead",this.alert=!0}var r=i.prototype;return r.getPosition=function(){},r.crossing=function(e){},r.destroy=function(){this.vector=null},i}(),tt=function(i){function r(t,n){var a;return(a=i.call(this)||this).x=t,a.y=n,a}u(r,i);var e=r.prototype;return e.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},e.crossing=function(t){this.alert&&(console.error("Sorry, PointZone does not support crossing method!"),this.alert=!1)},r}(N),Et=function(i){function r(t){var n;return(n=i.call(this)||this).zone=c.initValue(t,new tt),n.name="Position",n}u(r,i);var e=r.prototype;return e.reset=function(t){this.zone=c.initValue(t,new tt)},e.initialize=function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y},r}(_),At=function(i){function r(t,n,a){var s;return(s=i.call(this)||this).rPan=x.setSpanValue(t),s.thaPan=x.setSpanValue(n),s.type=c.initValue(a,"vector"),s.name="Velocity",s}u(r,i);var e=r.prototype;return e.reset=function(t,n,a){this.rPan=x.setSpanValue(t),this.thaPan=x.setSpanValue(n),this.type=c.initValue(a,"vector")},e.normalizeVelocity=function(t){return t*l.MEASURE},e.initialize=function(t){if(this.type==="p"||this.type==="P"||this.type==="polar"){var n=new ut(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*p.PI_180);t.v.x=n.getX(),t.v.y=n.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},r}(_),Pt=function(i){function r(e,t,n){var a;return(a=i.call(this)||this).massPan=x.setSpanValue(e,t,n),a.name="Mass",a}return u(r,i),r.prototype.initialize=function(e){e.mass=this.massPan.getValue()},r}(_),Rt=function(i){function r(t,n,a){var s;return(s=i.call(this)||this).radius=x.setSpanValue(t,n,a),s.name="Radius",s}u(r,i);var e=r.prototype;return e.reset=function(t,n,a){this.radius=x.setSpanValue(t,n,a)},e.initialize=function(t){t.radius=this.radius.getValue(),t.data.oldRadius=t.radius},r}(_),Tt=function(i){function r(t,n,a){var s;return(s=i.call(this)||this).image=s.setSpanValue(t),s.w=c.initValue(n,20),s.h=c.initValue(a,s.w),s.name="Body",s}u(r,i);var e=r.prototype;return e.initialize=function(t){var n=this.image.getValue();t.body=typeof n=="string"?{width:this.w,height:this.h,src:n,isInner:!0,inner:!0}:n},e.setSpanValue=function(t){return t instanceof O?t:new O(t)},r}(_),T=function(){function i(e,t){this.life=c.initValue(e,1/0),this.easing=d.getEasing(t),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.id="Behaviour_"+i.id++,this.name="Behaviour"}var r=i.prototype;return r.reset=function(e,t){this.life=c.initValue(e,1/0),this.easing=d.getEasing(t)},r.normalizeForce=function(e){return e.multiplyScalar(l.MEASURE)},r.normalizeValue=function(e){return e*l.MEASURE},r.initialize=function(e){},r.calculate=function(e,t,n){if(this.age+=t,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var a=this.easing(e.age/e.life);this.energy=Math.max(1-a,0)}},r.applyBehaviour=function(e,t,n){this.calculate(e,t,n)},r.destroy=function(){for(var e=this.parents.length;e--;)this.parents[e].removeBehaviour(this);this.parents.length=0},i}();T.id=0;var ft=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).force=o.normalizeForce(new f(t,n)),o.name="Force",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.force=this.normalizeForce(new f(t,n)),a&&i.prototype.reset.call(this,a,s)},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),t.a.add(this.force)},r}(T),pt=function(i){function r(t,n,a,s,o){var h;return(h=i.call(this,s,o)||this).targetPosition=c.initValue(t,new f),h.radius=c.initValue(a,1e3),h.force=c.initValue(h.normalizeValue(n),100),h.radiusSq=h.radius*h.radius,h.attractionForce=new f,h.lengthSq=0,h.name="Attraction",h}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s,o){this.targetPosition=c.initValue(t,new f),this.radius=c.initValue(a,1e3),this.force=c.initValue(this.normalizeValue(n),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new f,this.lengthSq=0,s&&i.prototype.reset.call(this,s,o)},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-5&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),t.a.add(this.attractionForce))},r}(T),wt=function(i){function r(t,n,a,s,o){var h;return(h=i.call(this,s,o)||this).reset(t,n,a),h.time=0,h.name="RandomDrift",h}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s,o){this.panFoce=new f(t,n),this.panFoce=this.normalizeForce(this.panFoce),this.delay=a,s&&i.prototype.reset.call(this,s,o)},e.initialize=function(t){t.data.time=0},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),t.data.time+=n,t.data.time>=this.delay&&(t.a.addXY(p.randomAToB(-this.panFoce.x,this.panFoce.x),p.randomAToB(-this.panFoce.y,this.panFoce.y)),t.data.time=0)},r}(T),Ct=function(i){function r(e,t,n){var a;return(a=i.call(this,0,e,t,n)||this).name="Gravity",a}return u(r,i),r.prototype.reset=function(e,t,n){i.prototype.reset.call(this,0,e,t,n)},r}(ft),It=function(i){function r(t,n,a,s,o){var h;return(h=i.call(this,s,o)||this).reset(t,n,a),h.newPool=[],h.pool=[],h.name="Collision",h}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s,o){this.emitter=c.initValue(t,null),this.mass=c.initValue(n,!0),this.callback=c.initValue(a,null),this.collisionPool=[],this.delta=new f,s&&i.prototype.reset.call(this,s,o)},e.applyBehaviour=function(t,n,a){this.emitter?c.sliceArray(this.emitter.particles,a,this.newPool):c.sliceArray(this.pool,a,this.newPool);var s,o,h,E,v,C,M,U=this.newPool.length;for(M=0;M<U;M++)if((s=this.newPool[M])!==t){this.delta.copy(s.p),this.delta.sub(t.p),o=this.delta.lengthSq();var S=t.radius+s.radius;o<=S*S&&(h=S-Math.sqrt(o),h+=.5,E=t.mass+s.mass,v=this.mass?s.mass/E:.5,C=this.mass?t.mass/E:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(h*-v)),s.p.add(this.delta.normalize().multiplyScalar(h*C)),this.callback&&this.callback(t,s))}},r}(T),Mt=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).reset(t,n),o.name="CrossZone",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.zone=t,this.zone.crossType=c.initValue(n,"dead"),a&&i.prototype.reset.call(this,a,s)},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),this.zone.crossing(t)},r}(T),St=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).reset(t,n),o.name="Alpha",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.same=n==null,this.a=x.setSpanValue(c.initValue(t,1)),this.b=x.setSpanValue(n),a&&i.prototype.reset.call(this,a,s)},e.initialize=function(t){t.data.alphaA=this.a.getValue(),this.same?t.data.alphaB=t.data.alphaA:t.data.alphaB=this.b.getValue()},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),t.alpha=t.data.alphaB+(t.data.alphaA-t.data.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)},r}(T),Dt=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).reset(t,n),o.name="Scale",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.same=n==null,this.a=x.setSpanValue(c.initValue(t,1)),this.b=x.setSpanValue(n),a&&i.prototype.reset.call(this,a,s)},e.initialize=function(t){t.data.scaleA=this.a.getValue(),t.data.oldRadius=t.radius,t.data.scaleB=this.same?t.data.scaleA:this.b.getValue()},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),t.scale=t.data.scaleB+(t.data.scaleA-t.data.scaleB)*this.energy,t.scale<1e-4&&(t.scale=0),t.radius=t.data.oldRadius*t.scale},r}(T),Bt=function(i){function r(t,n,a,s,o){var h;return(h=i.call(this,s,o)||this).reset(t,n,a),h.name="Rotate",h}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s,o){this.same=n==null,this.a=x.setSpanValue(c.initValue(t,"Velocity")),this.b=x.setSpanValue(c.initValue(n,0)),this.style=c.initValue(a,"to"),s&&i.prototype.reset.call(this,s,o)},e.initialize=function(t){t.rotation=this.a.getValue(),t.data.rotationA=this.a.getValue(),this.same||(t.data.rotationB=this.b.getValue())},e.applyBehaviour=function(t,n,a){this.calculate(t,n,a),this.same?this.a.a!=="V"&&this.a.a!=="Velocity"&&this.a.a!=="v"||(t.rotation=t.getDirection()):this.style==="to"||this.style==="TO"||this.style==="_"?t.rotation+=t.data.rotationB+(t.data.rotationA-t.data.rotationB)*this.energy:t.rotation+=t.data.rotationB},r}(T),Vt=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).reset(t,n),o.name="Color",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.a=O.createArraySpan(t),this.b=O.createArraySpan(n),a&&i.prototype.reset.call(this,a,s)},e.initialize=function(t){t.color=this.a.getValue(),t.data.colorA=P.hexToRgb(t.color),this.b&&(t.data.colorB=P.hexToRgb(this.b.getValue()))},e.applyBehaviour=function(t,n,a){this.b?(this.calculate(t,n,a),t.rgb.r=t.data.colorB.r+(t.data.colorA.r-t.data.colorB.r)*this.energy,t.rgb.g=t.data.colorB.g+(t.data.colorA.g-t.data.colorB.g)*this.energy,t.rgb.b=t.data.colorB.b+(t.data.colorA.b-t.data.colorB.b)*this.energy,t.rgb.r=t.rgb.r<<0,t.rgb.g=t.rgb.g<<0,t.rgb.b=t.rgb.b<<0):(t.rgb.r=t.data.colorA.r,t.rgb.g=t.data.colorA.g,t.rgb.b=t.data.colorA.b)},r}(T),st="changing",_t=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).setAngleAndForce(t,n),o.name="Cyclone",o}u(r,i);var e=r.prototype;return e.setAngleAndForce=function(t,n){this.force=st,this.angle=p.PI/2,t==="right"?this.angle=p.PI/2:t==="left"?this.angle=-p.PI/2:t==="random"?this.angle="random":t instanceof x?(this.angle="span",this.span=t):t&&(this.angle=t),String(n).toLowerCase()==="changing"||String(n).toLowerCase()==="chang"||String(n).toLowerCase()==="auto"?this.force=st:n&&(this.force=n)},e.reset=function(t,n,a,s){this.angle=p.PI/2,this.setAngleAndForce(t,n),a&&i.prototype.reset.call(this,a,s)},e.initialize=function(t){this.angle==="random"?t.data.cangle=p.randomAToB(-p.PI,p.PI):this.angle==="span"&&(t.data.cangle=this.span.getValue()),t.data.cyclone=new f(0,0)},e.applyBehaviour=function(t,n,a){var s;this.calculate(t,n,a);var o=t.v.getGradient();this.angle==="random"||this.angle==="span"?o+=t.data.cangle:o+=this.angle,s=this.force===st?t.v.length()/100:this.force,t.data.cyclone.x=s*Math.cos(o),t.data.cyclone.y=s*Math.sin(o),t.data.cyclone=this.normalizeForce(t.data.cyclone),t.a.add(t.data.cyclone)},r}(T),Ut=function(i){function r(e,t,n,a,s){var o;return(o=i.call(this,e,t,n,a,s)||this).force*=-1,o.name="Repulsion",o}return u(r,i),r.prototype.reset=function(e,t,n,a,s){i.prototype.reset.call(this,e,t,n,a,s),this.force*=-1},r}(pt),Lt=function(i){function r(t,n,a,s){var o;return(o=i.call(this,a,s)||this).distanceVec=new f,o.centerPoint=c.initValue(t,new f),o.force=c.initValue(o.normalizeValue(n),100),o.name="GravityWell",o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.distanceVec=new f,this.centerPoint=c.initValue(t,new f),this.force=c.initValue(this.normalizeValue(n),100),a&&i.prototype.reset.call(this,a,s)},e.initialize=function(t){},e.applyBehaviour=function(t,n,a){this.distanceVec.set(this.centerPoint.x-t.p.x,this.centerPoint.y-t.p.y);var s=this.distanceVec.lengthSq();if(s!==0){var o=this.distanceVec.length(),h=this.force*n/(s*o);t.v.x+=h*this.distanceVec.x,t.v.y+=h*this.distanceVec.y}},r}(T),Ft={initialize:function(i,r,e){var t,n=e.length;for(t=0;t<n;t++)e[t]instanceof _?e[t].init(i,r):this.init(i,r,e[t]);this.bindEmitter(i,r)},init:function(i,r,e){m.setProp(r,e),m.setVectorVal(r,e)},bindEmitter:function(i,r){i.bindEmitter&&(r.p.add(i.p),r.v.add(i.v),r.a.add(i.a),r.v.rotate(p.degreeTransform(i.rotation)))}},et=function(i){function r(t){var n;return t===void 0&&(t={}),(n=i.call(this,t)||this).particles=[],n.behaviours=[],n.initializes=[],n.emitTime=0,n.emitSpeed=0,n.totalTime=-1,n.damping=.006,n.bindEmitter=!0,n.rate=new dt(1,.1),n.name="Emitter",n.id=j.id(n.name),n}u(r,i);var e=r.prototype;return e.emit=function(t,n){this.stoped=!1,this.emitTime=0,this.totalTime=c.initValue(t,1/0),n===!0||n==="life"||n==="destroy"?this.life=t==="once"?1:this.totalTime:isNaN(n)||(this.life=n),this.rate.init()},e.stop=function(){this.totalTime=-1,this.emitTime=0,this.stoped=!0},e.preEmit=function(t){var n=this.stoped,a=this.emitTime,s=this.totalTime;this.stoped=!1,this.emitTime=0,this.totalTime=t,this.rate.init();for(var o=.0167;t>o;)t-=o,this.update(o);this.stoped=n,this.emitTime=a+Math.max(t,0),this.totalTime=s},e.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},e.addSelfInitialize=function(t){t.init&&t.init(this)},e.addInitialize=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var s=n.length;s--;)this.initializes.push(n[s])},e.removeInitialize=function(t){var n=this.initializes.indexOf(t);n>-1&&this.initializes.splice(n,1)},e.removeAllInitializers=function(){c.emptyArray(this.initializes)},e.addBehaviour=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var s=arguments.length;s--;){var o=n[s];this.behaviours.push(o),o.parents&&o.parents.push(this)}},e.removeBehaviour=function(t){var n=this.behaviours.indexOf(t);return this.behaviours.splice(n,1),t.parents&&(n=t.parents.indexOf(t),t.parents.splice(n,1)),n},e.removeAllBehaviours=function(){c.emptyArray(this.behaviours)},e.update=function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t)},e.integrate=function(t){if(this.parent){var n,a,s=1-this.damping;for(this.parent.integrator.calculate(this,t,s),n=this.particles.length-1;n>=0;n--)(a=this.particles[n]).update(t,n),this.parent.integrator.calculate(a,t,s),this.dispatch("PARTICLE_UPDATE",a),a.dead&&(this.dispatch("PARTICLE_DEAD",a),this.parent.pool.expire(a),this.particles.splice(n,1))}},e.dispatch=function(t,n){this.parent&&this.parent.dispatchEvent(t,n),this.bindEvent&&this.dispatchEvent(t,n)},e.emitting=function(t){if(this.totalTime==="once"){var n,a=this.rate.getValue(99999);for(a>0&&(this.emitSpeed=a),n=0;n<a;n++)this.createParticle();this.totalTime="none"}else if(this.emitTime+=t,this.emitTime<this.totalTime){var s,o=this.rate.getValue(t);for(o>0&&(this.emitSpeed=o),s=0;s<o;s++)this.createParticle()}},e.createParticle=function(t,n){var a=this.parent.pool.get(g);return this.setupParticle(a,t,n),this.dispatch("PARTICLE_CREATED",a),a},e.setupParticle=function(t,n,a){var s=this.initializes,o=this.behaviours;n&&(s=c.toArray(n)),a&&(o=c.toArray(a)),t.reset(),Ft.initialize(this,t,s),t.addBehaviours(o),t.parent=this,this.particles.push(t)},e.remove=function(){this.stop(),c.destroyAll(this.particles)},e.destroy=function(){this.dead=!0,this.remove(),this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this),this.rate=null,this.old=null,this.rgb=null,this.v=null,this.a=null,this.p=null},r}(g);$.bind(et);var K,zt=function(i){function r(t){var n;return(n=i.call(this,t)||this).selfBehaviours=[],n}u(r,i);var e=r.prototype;return e.addSelfBehaviour=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var s,o=n.length;for(s=0;s<o;s++){var h=n[s];this.selfBehaviours.push(h),h.initialize(this)}},e.removeSelfBehaviour=function(t){var n=this.selfBehaviours.indexOf(t);n>-1&&this.selfBehaviours.splice(n,1)},e.update=function(t){if(i.prototype.update.call(this,t),!this.sleep){var n,a=this.selfBehaviours.length;for(n=0;n<a;n++)this.selfBehaviours[n].applyBehaviour(this,t,n)}},r}(et),kt=function(i){function r(t,n,a){var s;return(s=i.call(this,a)||this).mouseTarget=c.initValue(t,window),s.ease=c.initValue(n,.7),s._allowEmitting=!1,s.initEventHandler(),s}u(r,i);var e=r.prototype;return e.initEventHandler=function(){var t=this;this.mousemoveHandler=function(n){return t.mousemove.call(t,n)},this.mousedownHandler=function(n){return t.mousedown.call(t,n)},this.mouseupHandler=function(n){return t.mouseup.call(t,n)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},e.emit=function(){this._allowEmitting=!0},e.stop=function(){this._allowEmitting=!1},e.mousemove=function(t){t.layerX||t.layerX===0?(this.p.x+=(t.layerX-this.p.x)*this.ease,this.p.y+=(t.layerY-this.p.y)*this.ease):(t.offsetX||t.offsetX===0)&&(this.p.x+=(t.offsetX-this.p.x)*this.ease,this.p.y+=(t.offsetY-this.p.y)*this.ease),this._allowEmitting&&i.prototype.emit.call(this,"once")},e.destroy=function(){i.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},r}(et),gt=function(i){if(!i)return!1;if(i.__isImage)return!0;var r=(""+i.tagName).toUpperCase();return((""+i.nodeName).toUpperCase()==="IMG"||r==="IMG")&&(i.__isImage=!0,!0)},mt=function(i){return typeof i=="string"},F=function(){function i(e,t){this.pool=new Z,this.element=e,this.stroke=t,this.circleConf={isCircle:!0},this.initEventHandler(),this.name="BaseRenderer"}var r=i.prototype;return r.setStroke=function(e,t){e===void 0&&(e="#000000"),t===void 0&&(t=1),this.stroke={color:e,thinkness:t}},r.initEventHandler=function(){var e=this;this._protonUpdateHandler=function(){e.onProtonUpdate.call(e)},this._protonUpdateAfterHandler=function(){e.onProtonUpdateAfter.call(e)},this._emitterAddedHandler=function(t){e.onEmitterAdded.call(e,t)},this._emitterRemovedHandler=function(t){e.onEmitterRemoved.call(e,t)},this._particleCreatedHandler=function(t){e.onParticleCreated.call(e,t)},this._particleUpdateHandler=function(t){e.onParticleUpdate.call(e,t)},this._particleDeadHandler=function(t){e.onParticleDead.call(e,t)}},r.init=function(e){this.parent=e,e.addEventListener("PROTON_UPDATE",this._protonUpdateHandler),e.addEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),e.addEventListener("EMITTER_ADDED",this._emitterAddedHandler),e.addEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),e.addEventListener("PARTICLE_CREATED",this._particleCreatedHandler),e.addEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),e.addEventListener("PARTICLE_DEAD",this._particleDeadHandler)},r.resize=function(e,t){},r.destroy=function(){this.remove(),this.pool.destroy(),this.pool=null,this.element=null,this.stroke=null},r.remove=function(e){this.parent.removeEventListener("PROTON_UPDATE",this._protonUpdateHandler),this.parent.removeEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),this.parent.removeEventListener("EMITTER_ADDED",this._emitterAddedHandler),this.parent.removeEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),this.parent.removeEventListener("PARTICLE_CREATED",this._particleCreatedHandler),this.parent.removeEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),this.parent.removeEventListener("PARTICLE_DEAD",this._particleDeadHandler),this.parent=null},r.onProtonUpdate=function(){},r.onProtonUpdateAfter=function(){},r.onEmitterAdded=function(e){},r.onEmitterRemoved=function(e){},r.onParticleCreated=function(e){},r.onParticleUpdate=function(e){},r.onParticleDead=function(e){},i}(),Ot=function(i){function r(t){var n;return(n=i.call(this,t)||this).stroke=null,n.context=n.element.getContext("2d"),n.bufferCache={},n.name="CanvasRenderer",n}u(r,i);var e=r.prototype;return e.resize=function(t,n){this.element.width=t,this.element.height=n},e.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},e.onParticleCreated=function(t){t.body?b(t.body,this.addImg2Body,t):t.color=t.color||"#ff0000"},e.onParticleUpdate=function(t){t.body?gt(t.body)&&this.drawImage(t):this.drawCircle(t)},e.onParticleDead=function(t){t.body=null},e.addImg2Body=function(t,n){n.body=t},e.drawImage=function(t){var n=t.body.width*t.scale|0,a=t.body.height*t.scale|0,s=t.p.x-n/2,o=t.p.y-a/2;if(t.color){t.data.buffer||(t.data.buffer=this.createBuffer(t.body));var h=t.data.buffer.getContext("2d");h.clearRect(0,0,t.data.buffer.width,t.data.buffer.height),h.globalAlpha=t.alpha,h.drawImage(t.body,0,0),h.globalCompositeOperation="source-atop",h.fillStyle=P.rgbToHex(t.rgb),h.fillRect(0,0,t.data.buffer.width,t.data.buffer.height),h.globalCompositeOperation="source-over",h.globalAlpha=1,this.context.drawImage(t.data.buffer,0,0,t.data.buffer.width,t.data.buffer.height,s,o,n,a)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(p.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.body,0,0,t.body.width,t.body.height,s,o,n,a),this.context.globalAlpha=1,this.context.restore()},e.drawCircle=function(t){t.rgb?this.context.fillStyle="rgba("+t.rgb.r+","+t.rgb.g+","+t.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},e.createBuffer=function(t){if(gt(t)){var n=t.width+"_"+t.height,a=this.bufferCache[n];return a||((a=document.createElement("canvas")).width=t.width,a.height=t.height,this.bufferCache[n]=a),a}},e.destroy=function(){i.prototype.destroy.call(this),this.stroke=null,this.context=null,this.bufferCache=null},r}(F),Nt=function(i){function r(t){var n;return(n=i.call(this,t)||this).stroke=null,n.transform3d=!1,n.pool.create=function(a,s){return n.createBody(a,s)},n.addImg2Body=n.addImg2Body.bind(D(n)),n.name="DomRenderer",n}u(r,i);var e=r.prototype;return e.onParticleCreated=function(t){t.body?b(t.body,this.addImg2Body,t):(t.body=this.pool.get(this.circleConf,t),this.element.appendChild(t.body))},e.onParticleUpdate=function(t){this.bodyReady(t)&&(this.transform3d?I.transform3d(t.body,t.p.x,t.p.y,t.scale,t.rotation):I.transform(t.body,t.p.x,t.p.y,t.scale,t.rotation),t.body.style.opacity=t.alpha,t.body.isCircle&&(t.body.style.backgroundColor=t.color||"#ff0000"))},e.onParticleDead=function(t){this.bodyReady(t)&&(this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null)},e.bodyReady=function(t){return typeof t.body=="object"&&t.body&&!t.body.isInner},e.addImg2Body=function(t,n){n.dead||(n.body=this.pool.get(t,n),I.resize(n.body,t.width,t.height),this.element.appendChild(n.body))},e.createBody=function(t,n){return t.isCircle?this.createCircle(n):this.createSprite(t,n)},e.createCircle=function(t){var n=I.createDiv(t.id+"_dom",2*t.radius,2*t.radius);return n.style.borderRadius=t.radius+"px",this.stroke&&(n.style.borderColor=this.stroke.color,n.style.borderWidth=this.stroke.thinkness+"px"),n.isCircle=!0,n},e.createSprite=function(t,n){var a=typeof t=="string"?t:t.src,s=I.createDiv(n.id+"_dom",t.width,t.height);return s.style.backgroundImage="url("+a+")",s},e.destroy=function(){i.prototype.destroy.call(this),this.stroke=null},r}(F),Ht=function(i){function r(t,n){var a;return(a=i.call(this,t)||this).stroke=n,a.name="EaselRenderer",a}u(r,i);var e=r.prototype;return e.onParticleCreated=function(t){t.body?this.createSprite(t):this.createCircle(t),this.element.addChild(t.body)},e.onParticleUpdate=function(t){t.body&&(t.body.x=t.p.x,t.body.y=t.p.y,t.body.alpha=t.alpha,t.body.scaleX=t.body.scaleY=t.scale,t.body.rotation=t.rotation)},e.onParticleDead=function(t){t.body&&(t.body.parent&&t.body.parent.removeChild(t.body),this.pool.expire(t.body),t.body=null),t.graphics&&this.pool.expire(t.graphics)},e.createSprite=function(t){t.body=this.pool.get(t.body),t.body.parent||t.body.image&&(t.body.regX=t.body.image.width/2,t.body.regY=t.body.image.height/2)},e.createCircle=function(t){var n=this.pool.get(createjs.Graphics);this.stroke&&(mt(this.stroke)?n.beginStroke(this.stroke):n.beginStroke("#000000")),n.beginFill(t.color||"#ff0000").drawCircle(0,0,t.radius);var a=this.pool.get(createjs.Shape,[n]);t.body=a,t.graphics=n},e.destroy=function(){i.prototype.destroy.call(this),this.stroke=null},r}(F),Xt=function(i){function r(t,n){var a;return(a=i.call(this,t)||this).context=a.element.getContext("2d"),a.imageData=null,a.rectangle=n,a.createImageData(n),a.name="PixelRenderer",a}u(r,i);var e=r.prototype;return e.resize=function(t,n){this.element.width=t,this.element.height=n},e.createImageData=function(t){this.rectangle=t||new ct(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},e.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},e.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},e.onParticleCreated=function(t){},e.onParticleUpdate=function(t){this.imageData&&this.setPixel(this.imageData,t.p.x-this.rectangle.x>>0,t.p.y-this.rectangle.y>>0,t)},e.setPixel=function(t,n,a,s){var o=s.rgb;if(!(n<0||n>this.element.width||a<0||a>this.element.height)){var h=4*((a>>0)*t.width+(n>>0));t.data[h]=o.r,t.data[h+1]=o.g,t.data[h+2]=o.b,t.data[h+3]=255*s.alpha}},e.onParticleDead=function(t){},e.destroy=function(){i.prototype.destroy.call(this),this.stroke=null,this.context=null,this.imageData=null,this.rectangle=null},r}(F),Gt=function(i){function r(t,n){var a;return(a=i.call(this,t)||this).stroke=n,a.color=!1,a.setColor=!1,a.blendMode=null,a.pool.create=function(s,o){return a.createBody(s,o)},a.setPIXI(window.PIXI),a.name="PixiRenderer",a}u(r,i);var e=r.prototype;return e.setPIXI=function(t){try{K=t||{Sprite:{}},this.createFromImage=K.Sprite.from||K.Sprite.fromImage}catch(n){}},e.onProtonUpdate=function(){},e.onParticleCreated=function(t){t.body?t.body=this.pool.get(t.body,t):t.body=this.pool.get(this.circleConf,t),this.blendMode&&(t.body.blendMode=this.blendMode),this.element.addChild(t.body)},e.onParticleUpdate=function(t){this.transform(t,t.body),this.setColor!==!0&&this.color!==!0||(t.body.tint=P.getHex16FromParticle(t))},e.onParticleDead=function(t){this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null},e.transform=function(t,n){n.x=t.p.x,n.y=t.p.y,n.alpha=t.alpha,n.scale.x=t.scale,n.scale.y=t.scale,n.rotation=t.rotation*p.PI_180},e.createBody=function(t,n){return t.isCircle?this.createCircle(n):this.createSprite(t)},e.createSprite=function(t){var n=t.isInner?this.createFromImage(t.src):new K.Sprite(t);return n.anchor.x=.5,n.anchor.y=.5,n},e.createCircle=function(t){var n=new K.Graphics;if(this.stroke){var a=mt(this.stroke)?this.stroke:0;n.beginStroke(a)}return n.beginFill(t.color||36077),n.drawCircle(0,0,t.radius),n.endFill(),n},e.destroy=function(t){i.prototype.destroy.call(this);for(var n=t.length;n--;){var a=t[n];a.body&&this.element.removeChild(a.body)}},r}(F),Yt=function(){function i(){this.mats=[],this.size=0;for(var e=0;e<20;e++)this.mats.push(w.create([0,0,0,0,0,0,0,0,0]))}var r=i.prototype;return r.set=function(e,t){t===0?w.set(e,this.mats[0]):w.multiply(this.mats[t-1],e,this.mats[t]),this.size=Math.max(this.size,t+1)},r.push=function(e){this.size===0?w.set(e,this.mats[0]):w.multiply(this.mats[this.size-1],e,this.mats[this.size]),this.size++},r.pop=function(){this.size>0&&this.size--},r.top=function(){return this.mats[this.size-1]},i}(),Wt=function(i){function r(t){var n;return(n=i.call(this,t)||this).gl=n.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),n.gl||alert("Sorry your browser do not suppest WebGL!"),n.initVar(),n.setMaxRadius(),n.initShaders(),n.initBuffers(),n.gl.blendEquation(n.gl.FUNC_ADD),n.gl.blendFunc(n.gl.SRC_ALPHA,n.gl.ONE_MINUS_SRC_ALPHA),n.gl.enable(n.gl.BLEND),n.addImg2Body=n.addImg2Body.bind(D(n)),n.name="WebGLRenderer",n}u(r,i);var e=r.prototype;return e.init=function(t){i.prototype.init.call(this,t),this.resize(this.element.width,this.element.height)},e.resize=function(t,n){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/t,this.smat[4]=1/n,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,t,n),this.element.width=t,this.element.height=n},e.setMaxRadius=function(t){this.circleCanvasURL=this.createCircle(t)},e.getVertexShader=function(){return["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join(`
`)},e.getFragmentShader=function(){return["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join(`
`)},e.initVar=function(){this.mstack=new Yt,this.umat=w.create([2,0,1,0,-2,0,-1,1,1]),this.smat=w.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},e.blendEquation=function(t){this.gl.blendEquation(this.gl[t])},e.blendFunc=function(t,n){this.gl.blendFunc(this.gl[t],this.gl[n])},e.getShader=function(t,n,a){var s=a?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return t.shaderSource(s,n),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS)?s:(alert(t.getShaderInfoLog(s)),null)},e.initShaders=function(){var t=this.getShader(this.gl,this.getFragmentShader(),!0),n=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,n),this.gl.attachShader(this.sprogram,t),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},e.initBuffers=function(){var t,n;this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,3,1,0,2,3]),this.gl.STATIC_DRAW);var a=[];for(n=0;n<100;n++)a.push(n);for(t=new Uint16Array(a),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW),a=[],n=0;n<100;n++)a.push(n,n+1,n+2);t=new Uint16Array(a),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)},e.createCircle=function(t){this.circleCanvasRadius=B(c.initValue(t,32));var n=I.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),a=n.getContext("2d");return a.beginPath(),a.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),a.closePath(),a.fillStyle="#FFF",a.fill(),n.toDataURL()},e.drawImg2Canvas=function(t){var n=t.body.width,a=t.body.height,s=B(t.body.width),o=B(t.body.height),h=t.body.width/s,E=t.body.height/o;this.texturebuffers[t.data.src]||(this.texturebuffers[t.data.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.data.texture=this.texturebuffers[t.data.src][0],t.data.vcBuffer=this.texturebuffers[t.data.src][1],t.data.tcBuffer=this.texturebuffers[t.data.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,h,0,0,E,E,E]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,n,0,0,a,n,a]),this.gl.STATIC_DRAW);var v=t.data.canvas.getContext("2d").getImageData(0,0,s,o);this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,v),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.data.textureLoaded=!0,t.data.textureWidth=n,t.data.textureHeight=a},e.onProtonUpdate=function(){},e.onParticleCreated=function(t){t.data.textureLoaded=!1,t.data.tmat=w.create(),t.data.tmat[8]=1,t.data.imat=w.create(),t.data.imat[8]=1,t.body?b(t.body,this.addImg2Body,t):(b(this.circleCanvasURL,this.addImg2Body,t),t.data.oldScale=t.radius/this.circleCanvasRadius)},e.addImg2Body=function(t,n){n.dead||(n.body=t,n.data.src=t.src,n.data.canvas=at(t),n.data.oldScale=1,this.drawImg2Canvas(n))},e.onParticleUpdate=function(t){t.data.textureLoaded&&(this.updateMatrix(t),this.gl.uniform3f(this.sprogram.color,t.rgb.r/255,t.rgb.g/255,t.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},e.onParticleDead=function(t){},e.updateMatrix=function(t){var n=G(-t.data.textureWidth/2,-t.data.textureHeight/2),a=G(t.p.x,t.p.y),s=t.rotation*p.PI_180,o=it(s),h=t.scale*t.data.oldScale,E=nt(h,h),v=Y(n,E);v=Y(v,o),v=Y(v,a),w.inverse(v,t.data.imat),v[2]=t.alpha,this.mstack.push(v)},e.destroy=function(){i.prototype.destroy.call(this),this.gl=null,this.mstack=null,this.umat=null,this.smat=null,this.texturebuffers=null},r}(F),jt=function(i){function r(e){var t;return(t=i.call(this,e)||this).name="CustomRenderer",t}return u(r,i),r}(F),yt=function(i){function r(t,n,a,s,o){var h;return h=i.call(this)||this,a-t>=0?(h.x1=t,h.y1=n,h.x2=a,h.y2=s):(h.x1=a,h.y1=s,h.x2=t,h.y2=n),h.dx=h.x2-h.x1,h.dy=h.y2-h.y1,h.minx=Math.min(h.x1,h.x2),h.miny=Math.min(h.y1,h.y2),h.maxx=Math.max(h.x1,h.x2),h.maxy=Math.max(h.y1,h.y2),h.dot=h.x2*h.y1-h.x1*h.y2,h.xxyy=h.dx*h.dx+h.dy*h.dy,h.gradient=h.getGradient(),h.length=h.getLength(),h.direction=c.initValue(o,">"),h}u(r,i);var e=r.prototype;return e.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},e.getDirection=function(t,n){var a=this.dy,s=-this.dx;return(a*t+s*n+this.dot)*(s===0?1:s)>0},e.getDistance=function(t,n){return(this.dy*t+-this.dx*n+this.dot)/Math.sqrt(this.xxyy)},e.getSymmetric=function(t){var n=t.getGradient(),a=2*(this.getGradient()-n),s=t.x,o=t.y;return t.x=s*Math.cos(a)-o*Math.sin(a),t.y=s*Math.sin(a)+o*Math.cos(a),t},e.getGradient=function(){return Math.atan2(this.dy,this.dx)},e.rangeOut=function(t){if(Math.abs(this.getGradient())<=p.PI/4){if(t.p.x<=this.maxx&&t.p.x>=this.minx)return!0}else if(t.p.y<=this.maxy&&t.p.y>=this.miny)return!0;return!1},e.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},e.crossing=function(t){if(this.crossType==="dead")if(this.direction===">"||this.direction==="R"||this.direction==="right"||this.direction==="down"){if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)&&(t.dead=!0)}else{if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)||(t.dead=!0)}else if(this.crossType==="bound"){if(!this.rangeOut(t))return;this.getDistance(t.p.x,t.p.y)<=t.radius&&(this.dx===0?t.v.x*=-1:this.dy===0?t.v.y*=-1:this.getSymmetric(t.v))}else this.crossType==="cross"&&this.alert&&(console.error("Sorry, LineZone does not support cross method!"),this.alert=!1)},r}(N),vt=function(i){function r(t,n,a){var s;return(s=i.call(this)||this).x=t,s.y=n,s.radius=a,s.angle=0,s.center={x:t,y:n},s}u(r,i);var e=r.prototype;return e.getPosition=function(){return this.angle=p.PIx2*Math.random(),this.randomRadius=Math.random()*this.radius,this.vector.x=this.x+this.randomRadius*Math.cos(this.angle),this.vector.y=this.y+this.randomRadius*Math.sin(this.angle),this.vector},e.setCenter=function(t,n){this.center.x=t,this.center.y=n},e.crossing=function(t){var n=t.p.distanceTo(this.center);this.crossType==="dead"?n-t.radius>this.radius&&(t.dead=!0):this.crossType==="bound"?n+t.radius>=this.radius&&this.getSymmetric(t):this.crossType==="cross"&&this.alert&&(console.error("Sorry, CircleZone does not support cross method!"),this.alert=!1)},e.getSymmetric=function(t){var n=t.v.getGradient(),a=2*(this.getGradient(t)-n),s=t.v.x,o=t.v.y;t.v.x=s*Math.cos(a)-o*Math.sin(a),t.v.y=s*Math.sin(a)+o*Math.cos(a)},e.getGradient=function(t){return-p.PI_2+Math.atan2(t.p.y-this.center.y,t.p.x-this.center.x)},r}(N),bt=function(i){function r(t,n,a,s){var o;return(o=i.call(this)||this).x=t,o.y=n,o.width=a,o.height=s,o}u(r,i);var e=r.prototype;return e.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},e.crossing=function(t){this.crossType==="dead"?((t.p.x+t.radius<this.x||t.p.x-t.radius>this.x+this.width)&&(t.dead=!0),(t.p.y+t.radius<this.y||t.p.y-t.radius>this.y+this.height)&&(t.dead=!0)):this.crossType==="bound"?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):this.crossType==="cross"&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&t.v.x>=0&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&t.v.y>=0&&(t.p.y=this.y-t.radius))},r}(N),Zt=function(i){function r(t,n,a,s){var o;return(o=i.call(this)||this).reset(t,n,a,s),o}u(r,i);var e=r.prototype;return e.reset=function(t,n,a,s){this.imageData=t,this.x=c.initValue(n,0),this.y=c.initValue(a,0),this.d=c.initValue(s,2),this.vectors=[],this.setVectors()},e.setVectors=function(){var t,n,a=this.imageData.width,s=this.imageData.height;for(t=0;t<a;t+=this.d)for(n=0;n<s;n+=this.d){var o=4*((n>>0)*a+(t>>0));this.imageData.data[o+3]>0&&this.vectors.push({x:t+this.x,y:n+this.y})}return this.vector},e.getBound=function(t,n){var a=4*((n>>0)*this.imageData.width+(t>>0));return this.imageData.data[a+3]>0},e.getPosition=function(){var t=c.getRandFromArray(this.vectors);return this.vector.copy(t)},e.getColor=function(t,n){t-=this.x;var a=4*(((n-=this.y)>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[a],g:this.imageData.data[a+1],b:this.imageData.data[a+2],a:this.imageData.data[a+3]}},e.crossing=function(t){this.crossType==="dead"?this.getBound(t.p.x-this.x,t.p.y-this.y)?t.dead=!0:t.dead=!1:this.crossType==="bound"&&(this.getBound(t.p.x-this.x,t.p.y-this.y)||t.v.negate())},e.destroy=function(){i.prototype.destroy.call(this),this.imageData=null},r}(N),qt={addEventListener:function(i,r){i.addEventListener("PROTON_UPDATE_AFTER",function(){return r()})},getStyle:function(i){i===void 0&&(i="#ff0000");var r=P.hexToRgb(i);return"rgba("+r.r+", "+r.g+", "+r.b+", 0.5)"},drawZone:function(i,r,e,t){var n=r.getContext("2d"),a=this.getStyle();this.addEventListener(i,function(){t&&n.clearRect(0,0,r.width,r.height),e instanceof tt?(n.beginPath(),n.fillStyle=a,n.arc(e.x,e.y,10,0,2*Math.PI,!0),n.fill(),n.closePath()):e instanceof yt?(n.beginPath(),n.strokeStyle=a,n.moveTo(e.x1,e.y1),n.lineTo(e.x2,e.y2),n.stroke(),n.closePath()):e instanceof bt?(n.beginPath(),n.strokeStyle=a,n.drawRect(e.x,e.y,e.width,e.height),n.stroke(),n.closePath()):e instanceof vt&&(n.beginPath(),n.strokeStyle=a,n.arc(e.x,e.y,e.radius,0,2*Math.PI,!0),n.stroke(),n.closePath())})},drawEmitter:function(i,r,e,t){var n=r.getContext("2d"),a=this.getStyle();this.addEventListener(i,function(){t&&n.clearRect(0,0,r.width,r.height),n.beginPath(),n.fillStyle=a,n.arc(e.p.x,e.p.y,10,0,2*Math.PI,!0),n.fill(),n.closePath()})}};return l.Particle=g,l.Pool=Z,l.Util=c,l.ColorUtil=P,l.MathUtil=p,l.Vector2D=l.Vector=f,l.Polar2D=l.Polar=ut,l.ArraySpan=O,l.Rectangle=ct,l.Rate=dt,l.ease=d,l.Span=x,l.Mat3=w,l.getSpan=function(i,r,e){return new x(i,r,e)},l.createArraySpan=O.createArraySpan,l.Initialize=l.Init=_,l.Life=l.L=xt,l.Position=l.P=Et,l.Velocity=l.V=At,l.Mass=l.M=Pt,l.Radius=l.R=Rt,l.Body=l.B=Tt,l.Behaviour=T,l.Force=l.F=ft,l.Attraction=l.A=pt,l.RandomDrift=l.RD=wt,l.Gravity=l.G=Ct,l.Collision=It,l.CrossZone=Mt,l.Alpha=St,l.Scale=l.S=Dt,l.Rotate=Bt,l.Color=Vt,l.Repulsion=Ut,l.Cyclone=_t,l.GravityWell=Lt,l.Emitter=et,l.BehaviourEmitter=zt,l.FollowEmitter=kt,l.Zone=N,l.LineZone=yt,l.CircleZone=vt,l.PointZone=tt,l.RectZone=bt,l.ImageZone=Zt,l.CanvasRenderer=Ot,l.DomRenderer=Nt,l.EaselRenderer=Ht,l.PixiRenderer=Gt,l.PixelRenderer=Xt,l.WebGLRenderer=l.WebGlRenderer=Wt,l.CustomRenderer=jt,l.Debug=qt,c.assign(l,d),l})},18334:function(J){(function(y,u){J.exports=u()})(this,function(){"use strict";return function(){for(var y=["ms","moz","webkit","o"],u=0;u<y.length&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[y[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[y[u]+"CancelAnimationFrame"]||window[y[u]+"CancelRequestAnimationFrame"]}(),{timer:0,state:"stop",animations:[],add:function(y){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,A={callback:y,fps:u,n:60/u,param:arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i:0};return this.animations.push(A),this.animations.length>=1&&this.start(),this},getIndex:function(y){for(var u=0;u<this.animations.length;u++)if(this.animations[u].callback===y)return u;return-1},remove:function(y){if(!(this.getIndex(y)<0))return this.deleteMap(y),this.animations.length===0&&this.stop(),this},deleteMap:function(y){var u=this.getIndex(y),A=this.animations[u];for(var D in A)delete A[D];this.animations.splice(u,1)},start:function(){if(this.state!=="start")return this.state="start",this.tick(),this},stop:function(){if(this.state!=="stop")return this.state="stop",cancelAnimationFrame(this.timer),this},tick:function(){var y=this;this.timer=requestAnimationFrame(function(){y.tick()});for(var u=0;u<this.animations.length;u++){var A=this.animations[u],D=A.callback,B=A.param;A.i++,A.i>=A.n&&(D(B),A.i=0)}}}})}}]);
